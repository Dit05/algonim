<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test</title>
    <script src="dist/Algonim.js"></script>
  </head>
  <body>
    <div style="margin: 0; padding: 0; width: 100%; height: 100vh;">
      <algonim-element delay=1000></algonim-element>
    </div>

    <footer>
      <hr>
      Algonim is licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU General Public License v3.0</a>.<br>
      Source available at <a href="https://github.com/Dit05/algonim"><code>https://github.com/Dit05/algonim</code></a>.
    </footer>

    <script defer="defer">
      const algonim = document.getElementsByTagName('algonim-element')[0]

      algonim.slideshow(async (alg) => {
        const code = alg.createModel('code')
        code.setLines([
          'i <- 3 // very long long line break me please',
          'while i>0 do',
          '\tprint(i)',
          '\ti <- i-1',
          'done'
        ])

        const fakeConsole = alg.createModel('code')
        const outputLines = [ 'Output: (totally not a CodeModel)' ]
        fakeConsole.setLines(outputLines)

        const graph = alg.createModel('graph')
        let node = graph.createNode()
        graph.root = node
        node.position.x = 48
        node.position.y = 48
        node.value = 149

        let node2 = graph.createNode()
        node2.connect(node, false)
        node2.position.x = 128
        node2.position.y = 192

        let layout = {
          'split': 'vertical',
          'ratio': 0.4,
          'left': graph,
          'right': {
            'split': 'horizontal',
            'top': code,
            'bottom': fakeConsole
          }
        }

        code.arrowLine = 0

        alg.setLayout(layout)

        await alg.keyframe()

        let i = 3
        const iSign = code.createSign(0)
        iSign.text = `${i}`

        code.arrowLine = 1
        await alg.keyframe()
        while(i > 0) {
          code.arrowLine = 2
          await alg.keyframe()
          outputLines.push(`${i}`)
          fakeConsole.setLines(outputLines)
          await alg.keyframe()
          i -= 1
          iSign.text = `${i}`
          code.arrowLine = 3
          await alg.keyframe()
          code.arrowLine = 1
          await alg.keyframe()
        }
        code.arrowLine = 4
        await alg.keyframe()

        code.arrowLine = null
        await alg.keyframe()

        iSign.destroy()
        code.createSign(4).text = 'Fin.'
        await alg.keyframe()
      })

      //alg.setupExample()
      //alg.redraw()
    </script>
  </body>
</html>
